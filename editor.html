
<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8">
  <title>–†–µ–¥–∞–∫—Ç–æ—Ä –î–æ–Ω–∞—Ç–æ—Ä—ñ–≤</title>
  <style>
    body { font-family: sans-serif; padding: 2rem; background: #f4f4f4; max-width: 800px; margin: auto; }
    input, button, select { margin: 0.3rem 0.5rem 0.3rem 0; padding: 0.4rem; }
    input[type=text] { width: 200px; }
    input[type=number] { width: 100px; }
    ul { padding-left: 1rem; }
    li { margin-bottom: 4px; cursor: pointer; }
    textarea { width: 100%; height: 250px; margin-top: 1rem; }
  </style>
</head>
<body>
<h1>–†–µ–¥–∞–∫—Ç–æ—Ä –î–æ–Ω–∞—Ç–æ—Ä—ñ–≤</h1>

<label>–Ü–º‚Äô—è: <input id="name" /></label>
<label>–°—É–º–∞: <input id="amount" type="number" /></label>
<button onclick="add()">+ –î–æ–¥–∞—Ç–∏</button>
<button onclick="clearAll()">üóë –û—á–∏—Å—Ç–∏—Ç–∏ –≤—Å—ñ</button>
<button onclick="download()">‚¨áÔ∏è –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ JSON</button>
<input type="file" accept=".json" onchange="loadFile(event)" />

<ul id="list"></ul>
<p><b>–ó–∞–≥–∞–ª—å–Ω–∞ —Å—É–º–∞:</b> <span id="total">0</span> –≥—Ä–Ω</p>
<textarea id="output" readonly></textarea>

<script>
let puzzles = [];
let thanks = [];
const colors = [
  "#E91E63", "#607D8B", "#009688", "#8BC34A", "#3F51B5", "#1976D2",
  "#FF5722", "#00BCD4", "#F44336", "#CDDC39", "#512DA8", "#689F38",
  "#009688", "#689F38", "#4CAF50", "#FFC107", "#673AB7", "#03A9F4",
  "#FF9800", "#9C27B0", "#C2185B", "#7B1FA2", "#0288D1", "#388E3C",
  "#F57C00", "#5D4037", "#0288D1", "#00796B", "#FFA000", "#0078D7"
];

function render() {
  const list = document.getElementById("list");
  const output = document.getElementById("output");
  const total = document.getElementById("total");
  list.innerHTML = "";
  let sum = 0;

  puzzles.forEach((item, i) => {
    sum += item.amount || 0;
    const li = document.createElement("li");
    li.textContent = `üß© ${item.name} ‚Äî ${item.amount} –≥—Ä–Ω`;
    li.style.color = item.color;
    li.onclick = () => editEntry("puzzle", i);
    list.appendChild(li);
  });

  thanks.forEach((item, i) => {
    sum += item.amount || 0;
    const li = document.createElement("li");
    li.textContent = `üôè ${item.name} ‚Äî ${item.amount} –≥—Ä–Ω`;
    li.onclick = () => editEntry("thanks", i);
    list.appendChild(li);
  });

  total.textContent = sum;
  output.value = JSON.stringify({ puzzles, thanks }, null, 2);
}

function add() {
  const name = document.getElementById("name").value.trim();
  const amount = parseInt(document.getElementById("amount").value) || 0;
  if (!name) return alert("–í–≤–µ–¥—ñ—Ç—å —ñ–º‚Äô—è");

  if (amount >= 2500) {
    const color = colors[puzzles.length % colors.length];
    puzzles.push({ id: "puzzle-" + String(puzzles.length + 1).padStart(2, "0"), name, amount, color });
  } else {
    thanks.push({ name, amount });
  }

  document.getElementById("name").value = "";
  document.getElementById("amount").value = "";
  render();
}

function editEntry(type, index) {
  const list = type === "puzzle" ? puzzles : thanks;
  const entry = list[index];
  const newName = prompt("–ù–æ–≤–µ —ñ–º‚Äô—è:", entry.name);
  if (newName === null) return;

  const newAmount = parseInt(prompt("–ù–æ–≤–∞ —Å—É–º–∞:", entry.amount));
  if (!newName.trim() || isNaN(newAmount)) return;

  entry.name = newName.trim();
  entry.amount = newAmount;
  render();
}

function clearAll() {
  if (confirm("–û—á–∏—Å—Ç–∏—Ç–∏ –≤—Å—ñ –∑–∞–ø–∏—Å–∏?")) {
    puzzles = [];
    thanks = [];
    render();
  }
}

function download() {
  const blob = new Blob([document.getElementById("output").value], { type: "application/json" });
  const a = document.createElement("a");
  a.href = URL.createObjectURL(blob);
  a.download = "data.json";
  a.click();
}

function loadFile(event) {
  const file = event.target.files[0];
  if (!file) return;
  const reader = new FileReader();
  reader.onload = function(e) {
    const json = JSON.parse(e.target.result);
    puzzles = json.puzzles || [];
    thanks = json.thanks || [];
    render();
  };
  reader.readAsText(file);
}
</script>
</body>
</html>
